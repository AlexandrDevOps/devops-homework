  # Домашнее задание к занятию "5.1. Основы виртуализации"

 ##  1. Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

### Ответ:

  * Под аппаратной виртуализацие понимается набор технологий и инструкций представленный в разных микропроцессорных архитектурах, позволяющий развернуть изолированные друг от друга гостевые ОС с помощью аппаратных средств (гипервизоров) без использования отдельной операционной системы, чаще всего сам гипервизор является этой операционной системой.
  * При Паравирутализации, гостевая ОС получает только те ресурсы, которые были выделены ей гипервизором установленным в поддерживаемой операционной системе. Гипервизор в данном случае - это программа, обеспечивающая промежуточный слой между ОС на которой она развернута и гостевой ОС виртуализацию которой необходимо обеспечить.
  * При использовании виртуализации на основе ОС контейнеры (условно виртуальные машины) используют все доступные ресурсы хостовой машины: аппаратные системные устройства, доступные области памяти, динамические библиотеки, но при этом изолированы друг от друга и используют ресурс одного ядра ОС на которой развернуты. Таким образом отсутствует как такой гипервизор, а контейнеры напрямую работают с ядром системы, но в изолированных средах.
  Основное отличие паравиртуализации от виртуализации уровня ОС в том, что немодифицированная ОС не осведомлена о виртуализации и использует двоичную трансляцию для перехвата вызовов ОС во время выполнения, программы запускаются в изолированных друг от друга средах - контейнерах. Паравиртуализация, гипервызовы используются вместо невиртуализируемых инструкций ОС, и весь этот процесс происходит во время компиляции, где обрабатываются эти инструкции.

  ## 2. Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

 ### Ответ:

  * Высоконагруженная база данных, чувствительная к отказу - Физический сервер:  
      Данное решение требуется для более высокого отклика как базы данных, так и приложений работающих непосредственно с ней. Плюс данное решение существенно сократит точки отказа в виде гостевых систем или гипервизоров.      
  * Различные web-приложения - Виртуализация уровня ОС (контейнеры):  
      Требуется меньше ресурсов, выше скорость масштабирования при необходимости расширения. Нет жестких требований к аппаратнымм ресурсам, требует меньше ресурсов на администрирование. Проще обеспечить более высокий уровень безопасности проекта.
  * Windows системы для использования Бухгалтерским отделом - Паравиртуализация:  
      Организация backup файлов существенно проще реализуема в виде клонирования виртуальной машины плюс для развертывания или восстановления нужны менее квалифицированные специалисты. Насыщенный рынок доступных кроссплатформенных решений включая решения от Microsoft. Простая миграция и телепортация существующей системы в случае апгрейда аппаратного парка.   
  * Системы, выполняющие высокопроизводительные расчеты на GPU - физический сервер:  
      Необходима высокая скорость работы системы без дополнительных "слоев" программного обеспечения. Меньше точек отказа самой системы.

   ## 3. Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор. 

  ### Ответ:

1. VMware vSphere позволит развернуть большое количество виртуальных машин и обеспечит необходимое быстродействие инфраструктуры. Довольно дорогое решение посколько лицензируется каждое ядро, но все необходимые инструменты для развертывания и поддержки инфраструктуры присутствуют.

2. Oracle VirtualBox простое, бесплатное, кросплатформенное opensource решение с открытым исходным кодом. Позволит развернуть достаточное количество серверов для данного ТЗ и обеспечить миграцию, телепортацию и переключение виртуальных машин в режиме реального времени. Широкий круг поддержки гостевых операционных систем, поддержка бесшовного режима с общим буфером и папками упростит взаимодействие между разными виртуальными машинами.

3. Microsoft Hyper-V в случае если приобретенные лицензии Windows включают в себя возможность развертывания виртуальных машин с помощью данной технологиии или как вариант взять доступную бесплатную альтернативу VirtualBox предварительно отключив Hyper-V на ядре системы, поскольку есть некоторые проблемы в совместной работе двух гипервизоров. Данные гипервизоры подходят для платформы Windows и хорошо интегрированы с ней. Плюс есть большое количество информации по развертыванию и настройке.

4. XEN - достаточно гибкое решение, обеспечивающее быстродействие  виртуальных Linux машин. В зависимости от задачи можно развернуть в двух вариантах в виде паравиртуализации или полной аппаратной виртуализации. Для случая с паравиртуализацией основное удобство в быстром развертывании гостевых машин поскольку достаточно заготовить шаблоны, а если необходимо в результате тестов обеспечить максимальное быстродействие то выбираем вариант с аппаратной виртуализацией.

## 4. Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией  одновременно) и что необходимо сделать для минимизации этих рисков и  проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду  или нет? Мотивируйте ваш ответ примерами.

### Ответ:

​	На мой взгляд к основным проблемам гетерогенной среды виртуализации можно отнести: 1. Высокую вероятность отказа из-за наличия нескольких уровней виртуализации и на каждом из них могут быть свои слабые места. 2. Низкое быстродействие при неправильном выборе компонент работающих в связке друг с другом для реализации такой модели. 3. Слабая масштабируемость такой системы из-за большого числа зависимых друг от друга технологий, гипервизоров и программ. 4. Высокая сложность развертывания, настройки и создания Backup файлов модели. 

​	Чтобы создать довольно надежную гетерогенную среду виртуализации необходимо четко понимать объемы задач, которые нужно решать, знать о совместимости технологий с помощью которых предстоит развертывать среду и иметь желательно опыт в их использовании.  Плюс необходимо автоматизировать процесс создания Backup на каждом из уровней среды и возможно рассмотреть вариант с зеркалом такой конструкции. 

​	Имеется практический опыт по развертыванию гетерогенной среды виртуализации. Толкнуло на это решение только одно - низкий бюджет выделенный на ПО и аппартную составляющую. Для зубной поликлиники с персоналом не более 7 человек требовалось развернуть систему с веб-интерфейсом и собственной базой для учета клиентов и плюс обеспечить работу бухгалтера и его помощника совместно на ресурсах одного сервера. Была развернута гетерогенная среда в виде основной системы Windows с отключенной виртуализацией на ядре и установлен VirtualBox, использовалась паравиртуализация. После создана гостевая виртуальная машина на основе Debian 10 и в ней была развернута виртуализация уровня ОС совместно с базой на postgresql. И для бухгалтеров была отдельно развернута гостевая система Windows для работы в 1С с клиент серверным приложением.  На каждом из уровней сделан скрипт для создания backup файлов, базы храняться на дисковом массиве RAID 1 (предварительно был сделан расчет скорости работы массива), с основной системы был снят образ для быстрого восстановления базовой среды и плюс с каждой виртуальной машины после и перед проведением регламентных работ делается snapshot. На данный момент все работает отличнно, но повторять данное решение не хочется, очень много моментов по настройке и поддержке данной инфраструктуры необходимо держать в голове, причем данные решения врядли пригодятся в более крупных проектах.
